Epochs [Qswap]:  15%|██████████████████████████████████▋                                                                                                                                                                                                    | 15/100 [00:47<04:24,  3.12s/it]
Epoch [1/100] - Loss: 29.2467, Accuracy: 0.1123
Eval - Loss: 2.8604, Accuracy: 0.0894
Epoch [2/100] - Loss: 28.1391, Accuracy: 0.1074
Eval - Loss: 2.8339, Accuracy: 0.1045
Epoch [3/100] - Loss: 28.1664, Accuracy: 0.1021
Eval - Loss: 2.8391, Accuracy: 0.0927
Epoch [4/100] - Loss: 28.3731, Accuracy: 0.1068
Eval - Loss: 2.9709, Accuracy: 0.1089
Epoch [5/100] - Loss: 28.3858, Accuracy: 0.1029
Eval - Loss: 2.7552, Accuracy: 0.1028
Epoch [6/100] - Loss: 28.3711, Accuracy: 0.1079
Eval - Loss: 2.8298, Accuracy: 0.0974
Epoch [7/100] - Loss: 27.8745, Accuracy: 0.1007
Eval - Loss: 2.9349, Accuracy: 0.0957
Epoch [8/100] - Loss: 28.4900, Accuracy: 0.1016
Eval - Loss: 2.9042, Accuracy: 0.1002
Epoch [9/100] - Loss: 28.3583, Accuracy: 0.1016
Eval - Loss: 2.8957, Accuracy: 0.1066
Epoch [10/100] - Loss: 28.7203, Accuracy: 0.0969
Eval - Loss: 2.9013, Accuracy: 0.1007
Epoch [11/100] - Loss: 28.2235, Accuracy: 0.0990
Eval - Loss: 2.8059, Accuracy: 0.0925
Epoch [12/100] - Loss: 28.4209, Accuracy: 0.1028
Eval - Loss: 2.8612, Accuracy: 0.0929
Epoch [13/100] - Loss: 28.0069, Accuracy: 0.1030
Eval - Loss: 2.8115, Accuracy: 0.1090
Epoch [14/100] - Loss: 27.9593, Accuracy: 0.1013
Eval - Loss: 2.9408, Accuracy: 0.0944
Epoch [15/100] - Loss: 28.8545, Accuracy: 0.0998
Eval - Loss: 2.9036, Accuracy: 0.1018
Epoch [16/100] - Loss: 27.9902, Accuracy: 0.0961
Eval - Loss: 2.9910, Accuracy: 0.1090
Epoch [17/100] - Loss: 28.2468, Accuracy: 0.1040
Eval - Loss: 2.7745, Accuracy: 0.0961
Epoch [18/100] - Loss: 28.5511, Accuracy: 0.0992
Eval - Loss: 2.8494, Accuracy: 0.0939
Epoch [19/100] - Loss: 28.5761, Accuracy: 0.0943
Eval - Loss: 2.8609, Accuracy: 0.0977
Epoch [20/100] - Loss: 28.5279, Accuracy: 0.1014
Eval - Loss: 2.7898, Accuracy: 0.0952
Epoch [21/100] - Loss: 28.2272, Accuracy: 0.0983
Eval - Loss: 2.8239, Accuracy: 0.0977
Epoch [22/100] - Loss: 28.2312, Accuracy: 0.0956
Eval - Loss: 2.8745, Accuracy: 0.0996
Epoch [23/100] - Loss: 28.4469, Accuracy: 0.0982
Eval - Loss: 2.8525, Accuracy: 0.0987
Epoch [24/100] - Loss: 28.5512, Accuracy: 0.0984
Eval - Loss: 2.9519, Accuracy: 0.1064
Epoch [25/100] - Loss: 28.5370, Accuracy: 0.1023
Eval - Loss: 2.8323, Accuracy: 0.1087
Epoch [26/100] - Loss: 29.0314, Accuracy: 0.0981
Eval - Loss: 2.7634, Accuracy: 0.1010
Epoch [27/100] - Loss: 28.3947, Accuracy: 0.0985
Eval - Loss: 2.9482, Accuracy: 0.1110
Epoch [28/100] - Loss: 28.8307, Accuracy: 0.0991
Eval - Loss: 2.8942, Accuracy: 0.0959
Epoch [29/100] - Loss: 28.4516, Accuracy: 0.0989
Eval - Loss: 2.8492, Accuracy: 0.0937
Epoch [30/100] - Loss: 28.1941, Accuracy: 0.0969
Eval - Loss: 2.8218, Accuracy: 0.1065
Epoch [31/100] - Loss: 28.6072, Accuracy: 0.0994
Eval - Loss: 2.8949, Accuracy: 0.0904
Epoch [32/100] - Loss: 28.4091, Accuracy: 0.1008
Eval - Loss: 2.8326, Accuracy: 0.0943
Epoch [33/100] - Loss: 28.4510, Accuracy: 0.1002
Eval - Loss: 2.9216, Accuracy: 0.1097
Epoch [34/100] - Loss: 28.5643, Accuracy: 0.1037
Eval - Loss: 2.7876, Accuracy: 0.1038
Epoch [35/100] - Loss: 28.3323, Accuracy: 0.1024
Eval - Loss: 2.7655, Accuracy: 0.0928
Epoch [36/100] - Loss: 28.8916, Accuracy: 0.0988
Eval - Loss: 2.7974, Accuracy: 0.1145
Epoch [37/100] - Loss: 28.5399, Accuracy: 0.0995
Eval - Loss: 2.8965, Accuracy: 0.0933
Epoch [38/100] - Loss: 28.2680, Accuracy: 0.0991
Eval - Loss: 2.7039, Accuracy: 0.0983
Epoch [39/100] - Loss: 28.3580, Accuracy: 0.1005
Eval - Loss: 2.7678, Accuracy: 0.0987
Epoch [40/100] - Loss: 28.2106, Accuracy: 0.0976
Eval - Loss: 2.8887, Accuracy: 0.0914
Epoch [41/100] - Loss: 29.0907, Accuracy: 0.0986
Eval - Loss: 2.8654, Accuracy: 0.0816
Epoch [42/100] - Loss: 28.2276, Accuracy: 0.0986
Eval - Loss: 2.9936, Accuracy: 0.1119
Epoch [43/100] - Loss: 28.6480, Accuracy: 0.1024
Eval - Loss: 2.7245, Accuracy: 0.1048
Epoch [44/100] - Loss: 28.5008, Accuracy: 0.1018
Eval - Loss: 2.8275, Accuracy: 0.1033
Epoch [45/100] - Loss: 28.4248, Accuracy: 0.0985
Eval - Loss: 2.8839, Accuracy: 0.0930
Epoch [46/100] - Loss: 28.2947, Accuracy: 0.1019
Eval - Loss: 2.8421, Accuracy: 0.1030
Epoch [47/100] - Loss: 28.6667, Accuracy: 0.1035
Eval - Loss: 2.8005, Accuracy: 0.1113
Epoch [48/100] - Loss: 28.3435, Accuracy: 0.1010
Eval - Loss: 2.8898, Accuracy: 0.0981
Epoch [49/100] - Loss: 28.5912, Accuracy: 0.1021
Eval - Loss: 2.7749, Accuracy: 0.1026
Epoch [50/100] - Loss: 28.5755, Accuracy: 0.1052
Eval - Loss: 2.8441, Accuracy: 0.0892
Epoch [51/100] - Loss: 28.6332, Accuracy: 0.0987
Eval - Loss: 2.8040, Accuracy: 0.0988
Epoch [52/100] - Loss: 28.4793, Accuracy: 0.0984
Eval - Loss: 2.9739, Accuracy: 0.0941
Epoch [53/100] - Loss: 28.3084, Accuracy: 0.0976
Eval - Loss: 2.8384, Accuracy: 0.0970
Epoch [54/100] - Loss: 28.1912, Accuracy: 0.0988
Eval - Loss: 2.8746, Accuracy: 0.1036
Epoch [55/100] - Loss: 28.6673, Accuracy: 0.1009
Eval - Loss: 2.8691, Accuracy: 0.1020
Epoch [56/100] - Loss: 28.3848, Accuracy: 0.1035
Eval - Loss: 2.8177, Accuracy: 0.1023
Epoch [57/100] - Loss: 28.5139, Accuracy: 0.0962
Eval - Loss: 2.8546, Accuracy: 0.0980
Epoch [58/100] - Loss: 28.7764, Accuracy: 0.0984
Eval - Loss: 2.9734, Accuracy: 0.0925
Traceback (most recent call last):
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 137, in <module>
    main()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 99, in main
    avg_loss, accuracy = train_dataset.train(
                         ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/datasets/Qswap.py", line 95, in train
    loss, num_correct = model.compute_loss(out = out, output_lengths=output_lengths, targets = targets, optimizer = optimizer)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/models/Transformer.py", line 155, in compute_loss
    loss.backward()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
