100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 239.56it/s]
Epoch [1/50] - Loss: 796.1978, Accuracy: 0.4125
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 229.17it/s]
Eval - Loss: 0.0105, Accuracy: 0.5640
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 259.23it/s]
Epoch [2/50] - Loss: 560.8876, Accuracy: 0.6065
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 234.59it/s]
Eval - Loss: 0.0084, Accuracy: 0.6428
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 263.47it/s]
Epoch [3/50] - Loss: 469.7205, Accuracy: 0.6703
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 238.72it/s]
Eval - Loss: 0.0071, Accuracy: 0.7054
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 259.98it/s]
Epoch [4/50] - Loss: 425.0826, Accuracy: 0.7029
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 230.24it/s]
Eval - Loss: 0.0066, Accuracy: 0.7297
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 259.97it/s]
Epoch [5/50] - Loss: 397.7693, Accuracy: 0.7218
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 271.70it/s]
Eval - Loss: 0.0060, Accuracy: 0.7539
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:02<00:00, 221.43it/s]
Epoch [6/50] - Loss: 367.0284, Accuracy: 0.7454
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 234.36it/s]
Eval - Loss: 0.0058, Accuracy: 0.7618
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:02<00:00, 216.19it/s]
Epoch [7/50] - Loss: 357.0685, Accuracy: 0.7542
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 230.63it/s]
Eval - Loss: 0.0058, Accuracy: 0.7613
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 262.01it/s]
Epoch [8/50] - Loss: 335.9458, Accuracy: 0.7682
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 264.21it/s]
Eval - Loss: 0.0053, Accuracy: 0.7895
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 258.59it/s]
Epoch [9/50] - Loss: 320.1044, Accuracy: 0.7798
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 232.76it/s]
Eval - Loss: 0.0056, Accuracy: 0.7750
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:01<00:00, 257.48it/s]
Epoch [10/50] - Loss: 308.0463, Accuracy: 0.7874
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 270.34it/s]
Eval - Loss: 0.0051, Accuracy: 0.7969
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:02<00:00, 214.11it/s]
Epoch [11/50] - Loss: 298.1964, Accuracy: 0.7944
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 259.23it/s]
Eval - Loss: 0.0053, Accuracy: 0.7862
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:02<00:00, 216.78it/s]
Epoch [12/50] - Loss: 296.3584, Accuracy: 0.7967
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 232.61it/s]
Eval - Loss: 0.0052, Accuracy: 0.7916
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [00:02<00:00, 220.88it/s]
Epoch [13/50] - Loss: 282.0458, Accuracy: 0.8064
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00<00:00, 230.23it/s]
Eval - Loss: 0.0049, Accuracy: 0.8037
 19%|█████████████████████████████████████████████▋                                                                                                                                                                                                        | 87/469 [00:00<00:01, 217.39it/s]
Traceback (most recent call last):
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 137, in <module>
    main()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 100, in main
    avg_loss, accuracy = train_dataset.train(
                         ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/datasets/sMNIST.py", line 49, in train
    optimizer.step()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
    return func.__get__(opt, opt.__class__)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/adam.py", line 223, in step
    adam(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/optimizer.py", line 154, in maybe_fallback
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/adam.py", line 784, in adam
    func(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/adam.py", line 595, in _multi_tensor_adam
    bias_correction2 = [
                       ^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/adam.py", line 596, in <listcomp>
    1 - beta2 ** _get_value(step) for step in device_state_steps
                 ^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/optim/optimizer.py", line 106, in _get_value
    return x.item() if isinstance(x, torch.Tensor) else x
           ^^^^^^^^
KeyboardInterrupt
