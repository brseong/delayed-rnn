Epochs [Qswap]:  14%|████████████████████████████████▎                                                                                                                                                                                                      | 14/100 [00:59<06:07,  4.28s/it]
Epoch [1/100] - Loss: 28.7244, Accuracy: 0.0989
Eval - Loss: 2.8606, Accuracy: 0.1025
Epoch [2/100] - Loss: 28.1793, Accuracy: 0.0979
Eval - Loss: 2.8340, Accuracy: 0.0910
Epoch [3/100] - Loss: 28.2136, Accuracy: 0.0983
Eval - Loss: 2.8391, Accuracy: 0.0906
Epoch [4/100] - Loss: 28.4359, Accuracy: 0.0983
Eval - Loss: 2.9714, Accuracy: 0.0988
Epoch [5/100] - Loss: 28.4278, Accuracy: 0.0975
Eval - Loss: 2.7552, Accuracy: 0.0890
Epoch [6/100] - Loss: 28.3808, Accuracy: 0.1001
Eval - Loss: 2.8292, Accuracy: 0.1010
Epoch [7/100] - Loss: 27.9112, Accuracy: 0.1015
Eval - Loss: 2.9349, Accuracy: 0.1042
Epoch [8/100] - Loss: 28.5014, Accuracy: 0.1013
Eval - Loss: 2.9039, Accuracy: 0.0972
Epoch [9/100] - Loss: 28.3699, Accuracy: 0.0975
Eval - Loss: 2.8949, Accuracy: 0.0843
Epoch [10/100] - Loss: 28.7210, Accuracy: 0.1000
Eval - Loss: 2.9014, Accuracy: 0.0977
Epoch [11/100] - Loss: 28.2327, Accuracy: 0.0983
Eval - Loss: 2.8055, Accuracy: 0.1030
Epoch [12/100] - Loss: 28.4123, Accuracy: 0.0993
Eval - Loss: 2.8603, Accuracy: 0.1098
Epoch [13/100] - Loss: 28.0274, Accuracy: 0.0991
Eval - Loss: 2.8119, Accuracy: 0.1031
Epoch [14/100] - Loss: 27.9721, Accuracy: 0.0991
Eval - Loss: 2.9408, Accuracy: 0.1001
Traceback (most recent call last):
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 137, in <module>
    main()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 99, in main
    avg_loss, accuracy = train_dataset.train(
                         ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/datasets/Qswap.py", line 94, in train
    out = model(x = inputs, lengths=lengths, out_lengths = targets.shape[1])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/models/Transformer.py", line 124, in forward
    decoder_output = layer(
                     ^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 1091, in forward
    + self._mha_block(
      ^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 1127, in _mha_block
    x = self.multihead_attn(
        ^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 1368, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/functional.py", line 6097, in multi_head_attention_forward
    q, k, v = _in_projection_packed(query, key, value, in_proj_weight, in_proj_bias)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/nn/functional.py", line 5518, in _in_projection_packed
    q_proj = linear(q, w_q, b_q)
             ^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
