Epochs [Qswap]:  15%|██████████████████████████████████▋                                                                                                                                                                                                    | 15/100 [00:31<02:58,  2.10s/it]
Epoch [1/100] - Loss: 29.0551, Accuracy: 0.1060
Eval - Loss: 2.8599, Accuracy: 0.0929
Epoch [2/100] - Loss: 28.1503, Accuracy: 0.1003
Eval - Loss: 2.8345, Accuracy: 0.1000
Epoch [3/100] - Loss: 28.1570, Accuracy: 0.1057
Eval - Loss: 2.8394, Accuracy: 0.1087
Epoch [4/100] - Loss: 28.3771, Accuracy: 0.0986
Eval - Loss: 2.9701, Accuracy: 0.0973
Epoch [5/100] - Loss: 28.0400, Accuracy: 0.1397
Eval - Loss: 2.5817, Accuracy: 0.3430
Epoch [6/100] - Loss: 26.5985, Accuracy: 0.2918
Eval - Loss: 2.4887, Accuracy: 0.3501
Epoch [7/100] - Loss: 25.2337, Accuracy: 0.3529
Eval - Loss: 2.4658, Accuracy: 0.4506
Epoch [8/100] - Loss: 24.1291, Accuracy: 0.4652
Eval - Loss: 2.3606, Accuracy: 0.5161
Epoch [9/100] - Loss: 22.3898, Accuracy: 0.5242
Eval - Loss: 2.0592, Accuracy: 0.6372
Epoch [10/100] - Loss: 20.9842, Accuracy: 0.6117
Eval - Loss: 1.8923, Accuracy: 0.7008
Epoch [11/100] - Loss: 20.2169, Accuracy: 0.6446
Eval - Loss: 1.7773, Accuracy: 0.7166
Epoch [12/100] - Loss: 19.1943, Accuracy: 0.6753
Eval - Loss: 1.9220, Accuracy: 0.6967
Epoch [13/100] - Loss: 18.6710, Accuracy: 0.6961
Eval - Loss: 1.7850, Accuracy: 0.7265
Epoch [14/100] - Loss: 18.0734, Accuracy: 0.7140
Eval - Loss: 1.7183, Accuracy: 0.7537
Epoch [15/100] - Loss: 18.3276, Accuracy: 0.7136
Eval - Loss: 1.7433, Accuracy: 0.7466
Epoch [16/100] - Loss: 17.8367, Accuracy: 0.7146
Eval - Loss: 1.7625, Accuracy: 0.7537
Traceback (most recent call last):
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 136, in <module>
    main()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/main.py", line 99, in main
    avg_loss, accuracy = train_dataset.train(
                         ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/datasets/Qswap.py", line 95, in train
    loss, num_correct = model.compute_loss(out = out, output_lengths=output_lengths, targets = targets, optimizer = optimizer)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/aiphw227/Delay_RNN/code/models/Transformer.py", line 155, in compute_loss
    loss.backward()
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home1/aiphw227/miniconda3/envs/rnn/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
